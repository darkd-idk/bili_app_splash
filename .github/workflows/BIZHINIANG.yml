EOF
          
          # 替换变量
          sed -i "s|\${{ env.OUTPUT_DIR }}|${{ env.OUTPUT_DIR }}|g" "$report_path"
          sed -i "s|\$album_count|$album_count|g" "$report_path"
          sed -i "s|\$file_count|$file_count|g" "$report_path"
          sed -i "s|\$log_summary|$log_summary|" "$report_path"
          
          echo "📊 Generated report at $report_path"

      # 步骤10: 上传制品
      - name: "Upload Sync Artifacts"
        uses: actions/upload-artifact@v4
        with:
          name: "wallpaper-sync-artifacts-${{ github.run_id }}"
          path: |
            ${{ env.REPORT_DIR }}/${{ env.REPORT_FILE }}
            ${{ env.URL_LIST_FILE }}
            wallpapers.log
          retention-days: 7

      # 步骤11: 最终状态
      - name: "Final Status"
        run: |
          echo "🎉 WALLPAPER SYNC COMPLETED SUCCESSFULLY"
          echo "========================================"
          echo "Timestamp: $(date -u '+%Y-%m-%d %H:%M:%S UTC')"
          echo "Workflow: $GITHUB_WORKFLOW"
          echo "Run ID: $GITHUB_RUN_ID"
          echo "Repository: $GITHUB_REPOSITORY"
          echo "Output Directory: ${{ env.OUTPUT_DIR }}"
